!function(){angular.module("angular-preview-img",["angularPreviewImg"]),angular.module("angularPreviewImg",[]).directive("previewImg",function(a,b){return{restrict:"E",replace:!0,template:'<div class="view-image-fs ngPreviewAnimate" ng-class="{previewImgShow: previewImgOpacity}" ng-show="previewImgShow"><div class="preview-title"><span class="file-name-fs">{{checkedImg.name || previewImgTitle}}</span><a ng-if="previewImgDesign" class="btn btn-ok" style="margin-left: 20px" href="/design/{{project.id}}?fileId={{checkedImg.id}}">{{modify}}</a><b ng-click="closePreviewImg()"></b></div><div class="left-show-img"><div><button class="left-view" ng-click="leftChangeImg()" ng-class="{unUse: files.length==0 || index == 0}"></button><img self-adapting class="file-img-fs" ng-src="{{checkedImg.imagePath}}" alt=""/><button class="right-view" ng-click="rightChangeImg()" ng-class="{unUse: files.length==0 || index == files.length-1}"></button></div></div><div class="right-img-list"><button class="up-view" ng-click="upMoveImg()"></button><ul class="right-img-list-ul" id="right-img-list-ul"><li class="preview-animate" ng-repeat="file in files" ng-style="{top: top}" ng-click="changeImg(file, $index)" ng-class="{checked: file.pos == index, unchecked: file.pos != index}"><img height="60" ng-src="{{file.imagePath}}" alt=""/></li></ul><button class="down-view" ng-click="downMoveImg()"></button></div></div>',link:function(c){var d=72,e=a.innerHeight-140;c.index=0,c.top=0,c.previewImgShow=!1;var f=function(){var a=document.getElementById("right-img-list-ul"),b=a.clientHeight,c=a.getElementsByTagName("li")[0],f=c.currentStyle||window.getComputedStyle(c),g=parseInt(c.offsetHeight)+parseInt(f.marginTop);g&&g>0&&(d=g),e=b&&e>0?b:e},g=function(){f(),c.selfAdapting=!1,c.selfAdapting=!0};a.addEventListener?a.addEventListener("resize",g):a.attachEvent&&a.attachEvent("resize",g),c.openPreviewImg=function(){for(var a=0,d=c.files.length;d>a;a++){var e=c.files[a];e.pos=a}c.index=0,c.checkedImg=c.files[c.index],document.getElementsByTagName("html")[0].style.overflow="hidden",c.previewImgShow=!0,c.selfAdapting=!0,b(function(){c.previewImgOpacity=!0,f()},20)},c.closePreviewImg=function(){c.previewImgOpacity=!1,b(function(){document.getElementsByTagName("html")[0].removeAttribute("style"),c.previewImgShow=!1,c.selfAdapting=!1},300)},c.changeImg=function(a,b){c.checkedImg=a,c.index=b,c.selfAdapting=!0},c.leftChangeImg=function(){if(c.index-=1,c.index<0)return void(c.index=0);if(c.index*d+c.top+10>e){var a=(Math.ceil(e/d)-1)*d;c.top=-((c.index+1)*d-a)}c.checkedImg=c.files[c.index],c.index*d<-c.top&&(c.top+=d)},c.rightChangeImg=function(){return c.index+=1,c.index>=c.files.length?void(c.index=c.files.length-1):(c.index*d<-c.top&&(c.top=-c.index*d),c.checkedImg=c.files[c.index],void(e<(c.index+1)*d&&(c.top-=d)))},c.downMoveImg=function(){c.data.files.length*d+c.top<e||(c.top-=d)},c.upMoveImg=function(){0!==c.top&&(c.top+=d)}}}}).directive("previewImgSingle",function(a,b){return{restrict:"E",replace:!0,template:'<div class="preview-single-img-container ngPreviewAnimate" ng-class="{previewImgShow:previewSingleOpacity}" ng-show="previewSingleShow"><div class="preview-file-mc cursor_decrease" ng-click="closePreviewSingleImg()"></div><div class="preview-single-img-big cursor_decrease" ng-click="closePreviewSingleImg()"><img img-vertical-align class="cursor_decrease" ng-src="{{previewSingleImg.imagePath}}" alt=""/></div></div>',link:function(a){a.closePreviewSingleImg=function(){a.previewSingleOpacity=!1,b(function(){document.getElementsByTagName("html")[0].removeAttribute("style"),a.previewSingleShow=!1},300)},a.openPreviewSingleImg=function(){a.previewSingleShow=!0,document.getElementsByTagName("html")[0].style.overflow="hidden",b(function(){a.previewSingleOpacity=!0},20)}}}}).directive("imgVerticalAlign",function(a){return{link:function(b,c){b.$watch("previewSingleShow",function(){var b=c[0].height,d=a.innerHeight;return b>d?(c.css({"margin-top":-d/2+20}),!0):void c.css("margin-top",-b/2+"px")})}}}).directive("selfAdapting",function(a){return{link:function(b,c){b.$watch("selfAdapting",function(){if(b.selfAdapting){var d=c[0].height,e=c[0].width,f=a.innerHeight,g=a.innerWidth;d>f-100&&c.css({"max-height":f-100}),e>g-300&&c.css({"max-width":g-300})}else c.removeAttr("style")})}}})}();